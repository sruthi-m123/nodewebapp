<%- include('../partials/admin/admin-header') %>
<link rel="stylesheet" href="/css/admin/viewDetailAdmin.css">
<div class="order-page-container">
  <div class="top-info">
    <div class="order-id">Order Id: <%= order.orderId %></div>
    <div class="order-date">
      <% const displayDate = order.orderDate || order.createdAt %>
      Order Date: <%= displayDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %>
    </div>
  </div>

  <div class="main-content">
    <div class="left-section">
      <div class="order-summary card">
        <h3>Order Summary</h3>
        <div class="summary-item">
          <span class="label">Total Amount:</span>
          <span class="value">Rs.<%= order.total%></span>
        </div>
        <div class="summary-item">
          <span class="label">Payment Method:</span>
          <span class="value"><%= order.paymentMethod %></span>
        </div>

        <div class="status-actions">
          <div class="status-select">
            <button class="status-btn"><%= order.status %></button>
            <select name="status" class="dropdown">
              <option value="processing">Processing</option>
              <option value="shipped">Shipped</option>
              <option value="delivered">Delivered</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>
          <button class="update-btn" data-order-id="<%= order._id %>">
            Update Status
          </button>
        </div>
      </div>

      <!-- Updated Products Section -->
      <div class="products-container card">
        <h3>Products (<%= order.items.length %>)</h3>
        <% order.items.forEach((item, index) => { %>
          <div class="product-card">
            <div class="product-image">
              <img src="/<%= item.productId.images[0] %>" alt="Product Image">
            </div>
            <div class="product-details">
              <div class="detail-row">
                <span class="label">Product Name:</span>
                <span class="value"><%= item.productId.productName %></span>
              </div>
              <div class="detail-row">
                <span class="label">Quantity:</span>
                <span class="value"><%= item.quantity %></span>
              </div>
              <div class="detail-row">
                <span class="label">Price:</span>
                <span class="value">Rs.<%= item.price %></span>
              </div>
              <div class="detail-row">
                <span class="label">Subtotal:</span>
                <span class="value">Rs.<%= (item.price * item.quantity).toFixed(2) %></span>
              </div>
            </div>
            <% if (index < order.items.length - 1) { %>
              <hr class="product-divider">
            <% } %>
          </div>
        <% }); %>
      </div>
    </div>

    <div class="shipping-address card">
      <h3>Shipping Address</h3>
      <div class="address-item">
        <span class="label">Name:</span>
        <span class="value"><%= order.shippingAddress.name %></span>
      </div>
      <div class="address-item">
        <span class="label">Address:</span>
        <span class="value">
          <%= order.shippingAddress.building %>,
          <%= order.shippingAddress.landmark %>,
          <%= order.shippingAddress.city %>,
          <%= order.shippingAddress.state %> -
          <%= order.shippingAddress.pincode %>
        </span>
      </div>
      <div class="address-item">
        <span class="label">Phone:</span>
        <span class="value"><%= order.shippingAddress.phone %></span>
      </div>
    </div>
  </div>
</div>
<%- include('../partials/admin/admin-footer') %>
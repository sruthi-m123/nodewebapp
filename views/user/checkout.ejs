<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Complete Your Order</title>
    <link rel="stylesheet" href="/css/checkout.css">
</head>
<body>
    <!-- Main Checkout Content -->
    <div class="main-content">
        <div class="container">
            <h1>Checkout</h1>
            <p class="subtitle">Review your order and complete your purchase</p>

            <div class="checkout-grid">
                <div class="left-column">
                    <!-- Address Selection -->
                    <div class="address-section">
                        <div class="section-title">
                            SELECT ADDRESS
                            <button class="btn" onclick="openAddressModal()">Add Address</button>
                        </div>
                        
                       <!-- views/checkout/checkout.ejs -->
<div class="address-list" id="addressList">
    <% addresses.forEach(address => { %>
        <div class="address-card <%= address.isDefault ? 'selected' : '' %>" 
             data-address-id="<%= address.id %>">
            <div class="address-name"><%= address.name %></div>
            <div class="address-details">
                <%= address.addressLine1 %><br>
                <% if (address.addressLine2) { %>
                    <%= address.addressLine2 %><br>
                <% } %>
                <%= address.city %>, <%= address.state %> <%= address.zipCode %><br>
                Phone: <%= address.phone %>
            </div>
            <div class="address-tags">
                <span class="tag <%= address.type %>">
                    <%= address.type.charAt(0).toUpperCase() + address.type.slice(1) %>
                </span>
                <% if (address.isDefault) { %>
                    <span class="tag default">Default</span>
                <% } %>
            </div>
            <a href="#" class="edit-address" onclick="editAddress(<%= address.id %>)">Edit</a>
        </div>
    <% }); %>
</div>
                        <div class="delivery-info">
                            <div class="delivery-title">Estimated Delivery Date</div>
                            <div class="delivery-date">Monday, 13 | 12:00 - 16:00</div>
                        </div>
                    </div>

                    <!-- Products in Cart -->
                    <div class="product-section">
                        <div class="section-title">ORDER ITEMS</div>
                        
                        <% cartItems.forEach(item => { %>
                        <div class="product-item">
                            <img src="<%= item.image %>" alt="<%= item.name %>" class="product-image">
                            <div class="product-details">
                                <div class="product-name"><%= item.name %></div>
                                <div class="product-variant"><%= item.variant %></div>
                                <div class="product-price-info">
                                    <div class="quantity-price">Qty: <%= item.quantity %> × ₹<%= item.price %></div>
                                    <div class="item-total">₹<%= item.quantity * item.price %></div>
                                </div>
                            </div>
                        </div>
                        <% }); %>
                    </div>

                    <!-- Offers Section -->
                    <div class="offers-section">
                        <div class="section-title">AVAILABLE OFFERS</div>
                        
                        <% offers.forEach(offer => { %>
                        <div class="offer-item">
                            <div class="offer-icon"><%= offer.icon %></div>
                            <div class="offer-details">
                                <div class="offer-title"><%= offer.title %></div>
                                <div class="offer-description"><%= offer.description %></div>
                                <div class="offer-code"><%= offer.code ? 'Code: ' + offer.code : 'T&C Apply' %></div>
                            </div>
                            <button class="apply-offer-btn <%= offer.applied ? 'applied' : '' %>" 
                                    onclick="<%= offer.applied ? 'removeOffer(\'' + offer.id + '\')' : 'applyOffer(\'' + offer.id + '\')' %>">
                                <%= offer.applied ? 'Applied' : 'Apply' %>
                            </button>
                        </div>
                        <% }); %>
                    </div>

                    <!-- Payment Options -->
                    <div class="payment-section">
                        <div class="section-title">PAYMENT OPTIONS</div>
                        
                        <div class="payment-methods">
                            <% paymentMethods.forEach(method => { %>
                            <div class="payment-option <%= method.id === selectedPayment ? 'selected' : '' %>" data-payment="<%= method.id %>">
                                <div class="payment-radio">
                                    <input type="radio" name="payment" id="<%= method.id %>" value="<%= method.id %>" <%= method.id === selectedPayment ? 'checked' : '' %>>
                                    <label for="<%= method.id %>"></label>
                                </div>
                                <div class="payment-info">
                                    <div class="payment-icon"><%= method.icon %></div>
                                    <div class="payment-details">
                                        <div class="payment-title"><%= method.title %></div>
                                        <div class="payment-description"><%= method.description %></div>
                                    </div>
                                </div>
                            </div>
                            <% }); %>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <div class="summary-title">ORDER SUMMARY</div>
                    
                    <div style="font-size: 16px; font-weight: 600; margin-bottom: 15px; color: #2c3e50;">CART TOTAL</div>
                    
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span>₹<%= subtotal %></span>
                    </div>
                    
                    <div class="summary-row">
                        <span>Delivery</span>
                        <span>₹<%= delivery %></span>
                    </div>
                    
                    <div class="summary-row">
                        <span>Tax (GST <%= taxRate %>%)</span>
                        <span>₹<%= tax %></span>
                    </div>
                    
                    <div class="summary-row">
                        <span>Discount</span>
                        <span style="color: #28a745;">-₹<%= discount %></span>
                    </div>
                    
                    <div class="summary-row total">
                        <span>TOTAL</span>
                        <span>₹<%= total %></span>
                    </div>

                    <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 14px; border: 1px solid #eee;">
                        <strong>Payment Method:</strong> <span id="selectedPaymentMethod"><%= selectedPaymentMethod %></span>
                    </div>
                    
                    <button class="continue-btn" onclick="placeOrder()">Place Order</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Success Page -->
    <div class="success-page" id="successPage">
        <div class="container">
            <div class="success-icon">✓</div>
            <h1 class="success-title">Order Placed Successfully!</h1>
            <p class="success-message">
                Thank you for your purchase! Your order has been confirmed and will be delivered to your selected address. 
                You will receive a confirmation email with your order details shortly.
            </p>
            <div class="success-buttons">
                <a href="/orders/<%= orderId %>" class="success-btn primary">View Order Details</a>
                <a href="/shop" class="success-btn secondary">Continue Shopping</a>
            </div>
        </div>
    </div>

    <!-- Add/Edit Address Modal -->
    <div class="modal" id="addressModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Add New Address</h3>
                <button class="close-btn" onclick="closeAddressModal()">&times;</button>
            </div>
            
            <form id="addressForm">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" id="fullName" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Address Line 1 *</label>
                    <input type="text" class="form-input" id="addressLine1" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Address Line 2</label>
                    <input type="text" class="form-input" id="addressLine2">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">City *</label>
                        <input type="text" class="form-input" id="city" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">State *</label>
                        <input type="text" class="form-input" id="state" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">ZIP Code *</label>
                        <input type="text" class="form-input" id="zipCode" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone *</label>
                        <input type="tel" class="form-input" id="phone" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Address Type</label>
                    <select class="form-input" id="addressType">
                        <option value="home">Home</option>
                        <option value="office">Office</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="setDefault">
                    <label for="setDefault">Set as default address</label>
                </div>
                
                <button type="submit" class="save-btn">Save Address</button>
            </form>
        </div>
    </div>

    <script src="/js/checkout.js"></script>
</body>
</html>